# === General Tmux Configuration ===

# Set the prefix key (Ctrl+b is the default, but Ctrl+a is popular for being easier to reach)
set -g prefix C-b
unbind C-a
bind C-b send-prefix

# Reload config file with 'r' key after prefix
bind r source-file ~/.config/tmux/tmux.conf \; display-message "Tmux config reloaded!"

# Use 24-bit true color
set -g default-terminal "tmux-256color"
set-option -ga terminal-features ",xterm-kitty:RGB" # For Kitty terminal specific features if you use it

# Increase scrollback buffer size
set -g history-limit 10000

# Enable mouse support
set -g mouse on

# Set window and pane indexing to start from 1 instead of 0
set -g base-index 1
set -g pane-base-index 1
set-window-option -g pane-base-index 1

# Automatically set window title
set-window-option -g automatic-rename on
set-option -g set-titles on

# Keep current path when splitting windows/panes
# bind '"' split-window -v -c "#{pane_current_path}"
# bind % split-window -h -c "#{pane_current_path}"

# Vi mode for copy/scroll
set-window-option -g mode-keys vi


# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible' # Sensible defaults for tmux
set -g @plugin 'tmux-plugins/tmux-yank'     # Tmux copy and paste with system clipboard
set -g @plugin 'tmux-plugins/tmux-resurrect' # Save and restore tmux environment
set -g @plugin 'tmux-plugins/tmux-continuum' # Continuous saving of tmux environment (requires resurrect)

# set -g @plugin 'samoshkin/tmux-plugin-sysstat' # System stats in status bar (CPU, memory, etc.)
set -g @plugin 'christoomey/vim-tmux-navigator' # Seamless navigation between vim panes and tmux panes (if you use Neovim/Vim)



# === tmux-yank configuration ===
# Yank with vim keybindings
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind-key -T copy-mode-vi Y send-keys -X copy-line # Yank entire line


bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# === Status Line Configuration (Catppuccin Integration) ===

# Run Catppuccin theme
run ~/.config/tmux/plugins/catppuccin/tmux/catppuccin.tmux

# Set Catppuccin flavor
set -g @catppuccin_flavor "mocha"

# Catppuccin window status customization
set -g @catppuccin_window_status_style "bold" # Use bold for default window status
set -g @catppuccin_window_default_text "#{window_name}"

# Current window status customization (make it stand out more)
set -g @catppuccin_window_status_current_style "fg=colour235,bg=#{@thm_peach},bold" # More contrast
set -g @catppuccin_window_status_current_text "#{window_name}"

set -g @catppuccin_window_status "icon"
set -g @catppuccin_window_default_fill "number"
set -g @catppuccin_window_number_position "left"

# Overall status bar position
set-window-option -g status-position top

# Status bar refresh interval (increase for more responsiveness, but higher CPU)
set -g status-interval 1

# Status bar lengths
set -g status-left-length 80 # Adjust based on content
set -g status-right-length 150 # Adjust based on content

# Left status bar (often used for session info or custom indicators)
set -g status-left "" # Keep it clean or add your session info here if desired

# Window status format (current window vs. other windows)
set -g window-status-format " #I:#W#{?window_flags,#{window_flags}, } " # Show index, name, and flags
set -g window-status-current-format " #I:#W#{?window_flags,#{window_flags}, } " # Same for current, style handles highlighting

# Right status bar (more dynamic information)
set -g status-right ""
set -ag status-right "#{E:@catppuccin_status_kube}" # Kubernetes context (if plugin is active)
set -ag status-right "#{E:@catppuccin_status_git}"   # Git status (if plugin is active)
set -ag status-right "#{E:@catppuccin_status_time}"  # Current time
set -ag status-right "#{E:@catppuccin_status_session}" # Tmux session info
set -ag status-right "#{E:@catppuccin_status_application}" # Application-specific status
# Consider adding system stats if you uncomment `tmux-plugin-sysstat`
# set -ag status-right "#(tmux-cpu) #(tmux-mem)"

# Align status bar components
set -g status-justify left # Left-align window list

# === Keybindings for Productivity ===

# Pane navigation (more intuitive with Alt/Option + Arrow keys if your terminal supports it)
bind -n M-h select-pane -L
bind -n M-l select-pane -R
bind -n M-k select-pane -U
bind -n M-j select-pane -D

# Resize panes (Ctrl + Arrow keys after prefix)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Use hjkl to move between panes
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

bind-key -r h select-pane -L
bind-key -r j select-pane -D
bind-key -r k select-pane -U
bind-key -r l select-pane -R

# Swap panes (prefix + { or })
# bind { swap-pane -U
# bind } swap-pane -D

# Kill current pane (prefix + x)
bind x kill-pane

# Kill current window (prefix + &)
bind & kill-window

# Synchronize panes (useful for running same command on multiple panes)
bind s set-window-option synchronize-panes

# Break pane into new window (prefix + !)
bind ! break-pane

# === Run TPM (always at the very end of your tmux.conf) ===
run '~/.config/tmux/plugins/tpm/tpm'
